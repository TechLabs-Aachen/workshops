(()=>{"use strict";window.currentComponent=null;class e{constructor(e){this.value=e,this.renderers=new Set}registerRender(){console.log("CurrentComponent",window.currentComponent),this.renderers.add(currentComponent)}triggerRender(){this.renderers.forEach((e=>{e&&e()}))}}const n=e=>({get:(n,t)=>(e.registerRender(),console.log("stateGet",n,t,n[t]),n[t])});function t(e,n){return t=>{n.value="function"==typeof t?t(n.value):t,e.triggerRender(),console.log("stateSet",n.value)}}function o(o){const r=new e,l=new Proxy({value:o},n(r));return[()=>()=>l.value,t(r,l)]}window.currentComponent=null;const r={appendChild:(e,n)=>{if(console.log("tljs.appendChild",e,n),Array.isArray(n))n.forEach(((n,t)=>{n.nodeType?r.appendChild(e,n):(console.log("tljs.appendChild string",n,e.childNodes[t]),e.childNodes[t]&&e.childNodes[t].nodeValue===n||(e.childNodes[t]?e.childNodes[t].nodeValue=n:r.appendChild(e,n)))}));else if(n.nodeType)console.log("tljs.appendChild nodeType",n),e.appendChild(n);else{const t=document.createTextNode(n);e.appendChild(t)}},createElement:(e,n)=>{if(console.log("tljs.createElement",e,n),"function"==typeof e)return e(n);const t=document.createElement(e);var o;return o=()=>{n&&Object.entries(n).forEach((([e,n])=>{if("children"===e)if(console.log("tljs.createElement children",n),"string"==typeof n)t.innerHTML=n;else if(Array.isArray(n)){const e=n.map((e=>"function"==typeof e?e():e));r.appendChild(t,e)}else r.appendChild(t,n);else if(e.startsWith("on")){console.log("tljs.createElement event",e,n);const o=e.substring(2).toLowerCase();t.addEventListener(o,n)}else console.log("tljs.createElement attribute",e,n),t.setAttribute(e,n)}))},window.currentComponent=o,console.log("runRender",window.currentComponent),currentComponent(),t}},l=r;function c(e,n){return l.createElement(e,n)}function s(e,n){return c(e,n)}function d(e){return s("p",{children:["Counter: ",e.count]})}document.getElementById("root").appendChild(c((function(){const[e,n]=o(0),[t,r]=o(1);return s("div",{children:[c(d,{count:e()}),c(d,{count:t()}),c("button",{onclick:()=>{n((e=>e+1)),r((e=>e+1)),console.log("click")},children:"Increment"})]})}),{}))})();